--ÕäÊŞµ°

--½Å±¾ºÅ
x300028_g_scriptId = 300028

--type
--0	= ÆÕÍ¨¹æÔò
--1 = ÆÕÍ¨RMB¹æÔò
--2 = ìÅÒ«RMB¹æÔò

x300028_g_petItems = {};
x300028_g_petItems[30309100] = {dataId=3009, type=1}	--»¹Í¯µ¤£ºÍÃ×Ó
x300028_g_petItems[30309101] = {dataId=3019, type=1}	--»¹Í¯µ¤£ºÑà×Ó
x300028_g_petItems[30309102] = {dataId=3029, type=1}	--»¹Í¯µ¤£ºÎÚ¹ê
x300028_g_petItems[30309103] = {dataId=3039, type=1}	--»¹Í¯µ¤£º¹·
x300028_g_petItems[30309104] = {dataId=3049, type=1}	--»¹Í¯µ¤£º´Ìâ¬
x300028_g_petItems[30309105] = {dataId=3059, type=1}	--»¹Í¯µ¤£ººï×Ó
x300028_g_petItems[30309106] = {dataId=3069, type=1}	--»¹Í¯µ¤£ºËÉÊó
x300028_g_petItems[30309107] = {dataId=3079, type=1}	--»¹Í¯µ¤£ºä½ĞÜ
x300028_g_petItems[30309108] = {dataId=3089, type=1}	--»¹Í¯µ¤£ºğĞğÄ
x300028_g_petItems[30309109] = {dataId=3099, type=1}	--»¹Í¯µ¤£ºòáòæ
x300028_g_petItems[30309110] = {dataId=3109, type=1}	--»¹Í¯µ¤£ºòùòğ
x300028_g_petItems[30309111] = {dataId=3119, type=1}	--»¹Í¯µ¤£º´óó«òë
x300028_g_petItems[30309112] = {dataId=3129, type=1}	--»¹Í¯µ¤£ºöùÓã
x300028_g_petItems[30309113] = {dataId=3139, type=1}	--»¹Í¯µ¤£ºÃ¨Í·Ó¥
x300028_g_petItems[30309114] = {dataId=3149, type=1}	--»¹Í¯µ¤£ºâµ
x300028_g_petItems[30309115] = {dataId=3159, type=1}	--»¹Í¯µ¤£ºÀÏ»¢
x300028_g_petItems[30309116] = {dataId=3169, type=1}	--»¹Í¯µ¤£ºÒ°Öí
x300028_g_petItems[30309117] = {dataId=3179, type=1}	--»¹Í¯µ¤£º±ù²Ï
x300028_g_petItems[30309118] = {dataId=3189, type=1}	--»¹Í¯µ¤£ºÓ¥
x300028_g_petItems[30309119] = {dataId=3199, type=1}	--»¹Í¯µ¤£ºÍÒÄñ
x300028_g_petItems[30309120] = {dataId=3209, type=1}	--»¹Í¯µ¤£º±ª×Ó
x300028_g_petItems[30309121] = {dataId=3219, type=1}	--»¹Í¯µ¤£º±±¼«ĞÜ
x300028_g_petItems[30309122] = {dataId=3229, type=1}	--»¹Í¯µ¤£º¿×È¸
x300028_g_petItems[30309123] = {dataId=3239, type=1}	--»¹Í¯µ¤£º½£³İ»¢
x300028_g_petItems[30309124] = {dataId=3249, type=1}	--»¹Í¯µ¤£º´óĞÉĞÉ
x300028_g_petItems[30309125] = {dataId=3259, type=1}	--»¹Í¯µ¤£ºÏ¬Å£
x300028_g_petItems[30309126] = {dataId=3269, type=1}	--»¹Í¯µ¤£ºÑ©õõ
x300028_g_petItems[30309127] = {dataId=3279, type=1}	--»¹Í¯µ¤£º½£Áú
x300028_g_petItems[30309128] = {dataId=3289, type=1}	--»¹Í¯µ¤£º²µÂí
x300028_g_petItems[30309129] = {dataId=3299, type=1}	--»¹Í¯µ¤£º»ÆÄñ
x300028_g_petItems[30309130] = {dataId=3309, type=1}	--»¹Í¯µ¤£ºÄêÊŞ
x300028_g_petItems[30309131] = {dataId=3319, type=1}	--»¹Í¯µ¤£ºÁú¹ê
x300028_g_petItems[30309132] = {dataId=3329, type=1}	--»¹Í¯µ¤£ºÓ¢ÕĞ
x300028_g_petItems[30309133] = {dataId=3339, type=1}	--»¹Í¯µ¤£º÷è÷ë
x300028_g_petItems[30309134] = {dataId=3349, type=1}	--»¹Í¯µ¤£ºòÔÁú
x300028_g_petItems[30309135] = {dataId=3359, type=1}	--»¹Í¯µ¤£º²ñÃ¨
x300028_g_petItems[30309136] = {dataId=3369, type=1}	--»¹Í¯µ¤£º¼¦
x300028_g_petItems[30309137] = {dataId=3379, type=1}	--»¹Í¯µ¤£ºÑ¼×Ó
x300028_g_petItems[30309138] = {dataId=3389, type=1}	--»¹Í¯µ¤£ºÉ½Ñò
x300028_g_petItems[30309139] = {dataId=3399, type=1}	--»¹Í¯µ¤£ºÃ«Â¿
x300028_g_petItems[30309140] = {dataId=3409, type=1}	--»¹Í¯µ¤£º¶ì
x300028_g_petItems[30309141] = {dataId=3419, type=1}	--»¹Í¯µ¤£º°ÔÍõÁú
x300028_g_petItems[30309142] = {dataId=3429, type=1}	--»¹Í¯µ¤£ºÆó¶ì
x300028_g_petItems[30309143] = {dataId=3439, type=1}	--»¹Í¯µ¤£º´üÊó
x300028_g_petItems[30309144] = {dataId=3449, type=1}	--»¹Í¯µ¤£ºÑ¼×ìÊŞ
x300028_g_petItems[30309145] = {dataId=3459, type=1}	--»¹Í¯µ¤£ºÖí
x300028_g_petItems[30309146] = {dataId=3469, type=1}	--»¹Í¯µ¤£ºÇàÍÜ
x300028_g_petItems[30309147] = {dataId=3479, type=1}	--»¹Í¯µ¤£ºĞ¡Ïó
x300028_g_petItems[30309148] = {dataId=3489, type=1}	--»¹Í¯µ¤£ºÑ©ºü
x300028_g_petItems[30309149] = {dataId=3499, type=1}	--»¹Í¯µ¤£ºÀÇ

--**********************************
-- ·µ»Ø1£º¼¼ÄÜÀàËÆµÄÎïÆ·£¬¿ÉÒÔ¼ÌĞøÀàËÆ¼¼ÄÜµÄÖ´ĞĞ£»·µ»Ø0£ºÖ´ĞĞ OnDefaultEvent¡£
--**********************************
function x300028_IsSkillLikeScript( sceneId, selfId )
	return 1
end

--**********************************
-- ·µ»Ø1£ºÒÑ¾­È¡Ïû¶ÔÓ¦Ğ§¹û£¬²»ÔÙÖ´ĞĞºóĞø²Ù×÷£»·µ»Ø0£ºÃ»ÓĞ¼ì²âµ½Ïà¹ØĞ§¹û£¬¼ÌĞøÖ´ĞĞ¡£
--**********************************
function x300028_CancelImpacts( sceneId, selfId )
	return 0
end

--**********************************
-- Ìõ¼ş¼ì²âÈë¿Ú£º·µ»Ø1£ºÌõ¼ş¼ì²âÍ¨¹ı£¬¿ÉÒÔ¼ÌĞøÖ´ĞĞ£»·µ»Ø0£ºÌõ¼ş¼ì²âÊ§°Ü£¬ÖĞ¶ÏºóĞøÖ´ĞĞ¡£
--**********************************
function x300028_OnConditionCheck( sceneId, selfId )
	-- Ğ£ÑéÊ¹ÓÃµÄÎïÆ·
	if LuaFnVerifyUsedItem( sceneId, selfId ) ~= 1 then
		return 0
	end
	
	local itemTblIndex = LuaFnGetItemIndexOfUsedItem( sceneId, selfId );
	local petItem = x300028_g_petItems[itemTblIndex];
	if not petItem then
		x300028_NotifyFailTips(sceneId, selfId, "Chßa m· ğÕo cø, không th¬ sØ døng.");
		return 0;
	end
	
	local humanLevel = LuaFnGetLevel(sceneId, selfId);
	local tarPetLevel = GetPetTakeLevel(petItem.dataId);
	local tarPetName = GetPetName(petItem.dataId);
	if not humanLevel or not tarPetLevel or not tarPetName then
		x300028_NotifyFailTips(sceneId, selfId, "Chßa m· ğÕo cø, không th¬ sØ døng.");
		return 0;
	end
	
	if humanLevel < tarPetLevel then
		x300028_NotifyFailTips(sceneId, selfId, "Các hÕ c¥n ğÕt ğªn "..tarPetLevel.." m¾i có th¬ mang theo "..tarPetName..".");
		return 0;
	end

	petGUID_H = LuaFnGetHighSectionOfTargetPetGuid( sceneId, selfId )
	petGUID_L = LuaFnGetLowSectionOfTargetPetGuid( sceneId, selfId )

	if LuaFnPetCanReturnToChild( sceneId, selfId, petGUID_H, petGUID_L, 1, petItem.dataId) == 0 then
		return 0
	end

	return 1
end

--**********************************
--ÏûºÄ¼ì²â¼°´¦ÀíÈë¿Ú£¬¸ºÔğÏûºÄµÄ¼ì²âºÍÖ´ĞĞ£º
--·µ»Ø1£ºÏûºÄ´¦ÀíÍ¨¹ı£¬¿ÉÒÔ¼ÌĞøÖ´ĞĞ£»·µ»Ø0£ºÏûºÄ¼ì²âÊ§°Ü£¬ÖĞ¶ÏºóĞøÖ´ĞĞ¡£
--**********************************
function x300028_OnDeplete( sceneId, selfId )
	if LuaFnDepletingUsedItem( sceneId, selfId ) > 0 then
		return 1
	end

	return 0
end

--**********************************
--Ö»»áÖ´ĞĞÒ»´ÎÈë¿Ú£º
--¾ÛÆøºÍË²·¢¼¼ÄÜ»áÔÚÏûºÄÍê³Éºóµ÷ÓÃÕâ¸ö½Ó¿Ú£¨¾ÛÆø½áÊø²¢ÇÒ¸÷ÖÖÌõ¼ş¶¼Âú×ãµÄÊ±ºò£©£¬¶øÒıµ¼
--¼¼ÄÜÒ²»áÔÚÏûºÄÍê³Éºóµ÷ÓÃÕâ¸ö½Ó¿Ú£¨¼¼ÄÜµÄÒ»¿ªÊ¼£¬ÏûºÄ³É¹¦Ö´ĞĞÖ®ºó£©¡£
--·µ»Ø1£º´¦Àí³É¹¦£»·µ»Ø0£º´¦ÀíÊ§°Ü¡£
--×¢£ºÕâÀïÊÇ¼¼ÄÜÉúĞ§Ò»´ÎµÄÈë¿Ú
--**********************************
function x300028_OnActivateOnce( sceneId, selfId )
	local itemTblIndex = LuaFnGetItemIndexOfUsedItem( sceneId, selfId );
	local petItem = x300028_g_petItems[itemTblIndex];
	if not petItem then
		x300028_NotifyFailTips(sceneId, selfId, "Chßa m· ğÕo cø, không th¬ sØ døng.");
		return 0;
	end

	local petGUID_H = LuaFnGetHighSectionOfTargetPetGuid(sceneId, selfId);
	local petGUID_L = LuaFnGetLowSectionOfTargetPetGuid(sceneId, selfId);

	LuaFnPetReturnToChild( sceneId, selfId, petGUID_H, petGUID_L, petItem.type, petItem.dataId)
	LuaFnSendSpecificImpactToUnit(sceneId, selfId, selfId, selfId, 18, 0);
	return 1
end

--**********************************
--Òıµ¼ĞÄÌø´¦ÀíÈë¿Ú£º
--Òıµ¼¼¼ÄÜ»áÔÚÃ¿´ÎĞÄÌø½áÊøÊ±µ÷ÓÃÕâ¸ö½Ó¿Ú¡£
--·µ»Ø£º1¼ÌĞøÏÂ´ÎĞÄÌø£»0£ºÖĞ¶ÏÒıµ¼¡£
--×¢£ºÕâÀïÊÇ¼¼ÄÜĞÄÌøÊ±ÉúĞ§µÄÈë¿Ú
--**********************************
function x300028_OnActivateEachTick( sceneId, selfId )
	return 1
end

--**********************************
-- ĞÑÄ¿Ê§°ÜÌáÊ¾
--**********************************
function x300028_NotifyFailTips( sceneId, selfId, Tip )
	BeginEvent( sceneId )
		AddText( sceneId, Tip )
	EndEvent( sceneId )
	DispatchMissionTips( sceneId, selfId )
end
