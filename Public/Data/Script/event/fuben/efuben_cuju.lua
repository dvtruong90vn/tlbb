-- 402040 
-- õí¾Ï¸±±¾

--************************************************************************

--½Å±¾ºÅ
x402040_g_ScriptId = 402040

x402040_TIME_2000_01_03_ = 946828868

--************************************************************************

--¸±±¾Ãû³Æ
x402040_g_CopySceneName = "Mçu Ðan Uy¬n"

x402040_g_CopySceneType = FUBEN_CUJU	--¸±±¾ÀàÐÍ£¬¶¨ÒåÔÚScriptGlobal.luaÀïÃæ

x402040_g_CopySceneMap = "cuju.nav"
x402040_g_Exit = "cuju.ini"
x402040_g_LimitMembers = 1				--¿ÉÒÔ½ø¸±±¾µÄ×îÐ¡¶ÓÎéÈËÊý
x402040_g_TickTime = 1						--»Øµ÷½Å±¾µÄÊ±ÖÓÊ±¼ä£¨µ¥Î»£ºÃë/´Î£©
x402040_g_LimitTotalHoldTime = 360--¸±±¾¿ÉÒÔ´æ»îµÄÊ±¼ä£¨µ¥Î»£º´ÎÊý£©,Èç¹û´ËÊ±¼äµ½ÁË£¬ÔòÈÎÎñ½«»áÊ§°Ü
x402040_g_LimitTimeSuccess = 500	--¸±±¾Ê±¼äÏÞÖÆ£¨µ¥Î»£º´ÎÊý£©£¬Èç¹û´ËÊ±¼äµ½ÁË£¬ÈÎÎñÍê³É
x402040_g_CloseTick = 3						--¸±±¾¹Ø±ÕÇ°µ¹¼ÆÊ±£¨µ¥Î»£º´ÎÊý£©
x402040_g_NoUserTime = 300				--¸±±¾ÖÐÃ»ÓÐÈËºó¿ÉÒÔ¼ÌÐø±£´æµÄÊ±¼ä£¨µ¥Î»£ºÃë£©
x402040_g_DeadTrans = 0						--ËÀÍö×ªÒÆÄ£Ê½£¬0£ºËÀÍöºó»¹¿ÉÒÔ¼ÌÐøÔÚ¸±±¾£¬1£ºËÀÍöºó±»Ç¿ÖÆÒÆ³ö¸±±¾
x402040_g_Fuben_X = 38						--½øÈë¸±±¾µÄÎ»ÖÃX
x402040_g_Fuben_Z = 32						--½øÈë¸±±¾µÄÎ»ÖÃZ
x402040_g_Back_X = 203							--Ô´³¡¾°Î»ÖÃX
x402040_g_Back_Z = 56							--Ô´³¡¾°Î»ÖÃZ
x402040_g_Back_SceneId = 0				--Ô´³¡¾°Id

x402040_g_BossPoint={x=61, z=57}

x402040_g_MonsterPoint=
{
	{x=41,z=32},{x=46,z=32},{x=51,z=32},{x=56,z=32},{x=61,z=32},{x=66,z=32},
	{x=71,z=32},{x=76,z=32},{x=81,z=32},{x=86,z=32},{x=86,z=37},{x=86,z=42},
	{x=86,z=47},{x=86,z=52},{x=86,z=57},{x=86,z=62},{x=86,z=67},{x=86,z=72},
	{x=86,z=77},{x=86,z=82},{x=86,z=87},{x=86,z=92},{x=86,z=97},{x=86,z=102},
	{x=81,z=102},{x=76,z=102},{x=71,z=102},{x=66,z=102},{x=61,z=102},{x=56,z=102},
	{x=51,z=102},{x=46,z=102},{x=41,z=102},{x=41,z=97},{x=41,z=92},{x=41,z=87},
	{x=41,z=82},{x=41,z=77},{x=41,z=72},{x=41,z=67},{x=41,z=62},{x=41,z=57},
	{x=41,z=52},{x=41,z=47},{x=41,z=42},{x=41,z=37},{x=46,z=37},{x=51,z=37},
	{x=56,z=37},{x=61,z=37},{x=66,z=37},{x=71,z=37},{x=76,z=37},{x=81,z=37},
	{x=81,z=42},{x=81,z=47},{x=81,z=52},{x=81,z=57},{x=81,z=62},{x=81,z=67},
	{x=81,z=72},{x=81,z=77},{x=81,z=82},{x=81,z=87},{x=81,z=92},{x=81,z=97},
	{x=76,z=97},{x=71,z=97},{x=66,z=97},{x=61,z=97},{x=56,z=97},{x=51,z=97},
	{x=46,z=97},{x=46,z=92},{x=46,z=87},{x=46,z=82},{x=46,z=77},{x=46,z=72},
	{x=46,z=67},{x=46,z=62},{x=46,z=57},{x=46,z=52},{x=46,z=47},{x=46,z=42},
	{x=51,z=42},{x=56,z=42},{x=61,z=42},{x=66,z=42},{x=71,z=42},{x=76,z=42},
	{x=76,z=47},{x=76,z=52},{x=76,z=57},{x=76,z=62},{x=76,z=67},{x=76,z=72},
	{x=76,z=77},{x=76,z=82},{x=76,z=87},{x=76,z=92},{x=71,z=92},{x=66,z=92},
	{x=61,z=92},{x=56,z=92},{x=51,z=92},{x=51,z=87},{x=51,z=82},{x=51,z=77},
	{x=51,z=72},{x=51,z=67},{x=51,z=62},{x=51,z=57},{x=51,z=52},{x=51,z=47},
	{x=56,z=47},{x=61,z=47},{x=66,z=47},{x=71,z=47},{x=71,z=52},{x=71,z=57},
	{x=71,z=62},{x=71,z=67},{x=71,z=72},{x=71,z=77},{x=71,z=82},{x=71,z=87},
	{x=66,z=87},{x=61,z=87},{x=56,z=87},{x=56,z=82},{x=56,z=77},{x=56,z=72},
	{x=56,z=67},{x=56,z=62},{x=56,z=57},{x=56,z=52},{x=61,z=52},{x=66,z=52},
	{x=66,z=57},{x=66,z=62},{x=66,z=67},{x=66,z=72},{x=66,z=77},{x=66,z=82},
	{x=61,z=82},{x=61,z=77},{x=61,z=72},{x=61,z=67},{x=61,z=62},
}

x402040_g_NianShouPoint = 
{
	{x=40,z=100},{x=40,z=92},{x=40,z=84},{x=40,z=76},{x=40,z=68},
	{x=40,z=60},{x=40,z=52}, {x=64,z=30},{x=50,z=30},{x=78,z=30},
	{x=90,z=100},{x=90,z=92},{x=90,z=84},{x=90,z=76},{x=90,z=68},
	{x=90,z=60},{x=90,z=52},{x=60,z=103},{x=50,z=103},{x=78,z=103},
	
}

-- ×ãÇò£¬²»»áÖ÷¶¯¹¥»÷		
-- Hoàng S¡c Túc C¥u
x402040_g_SmallMonsterId_1={3680,3681,3682,3683,3684,3685,3686,3687,3688,3689,33680,33681,33682,33683,33684,33685,33686,33687,33688,33689}
-- H°ng S¡c Túc C¥u
x402040_g_SmallMonsterId_2={3690,3691,3692,3693,3694,3695,3696,3697,3698,3699,33690,33691,33692,33693,33694,33695,33696,33697,33698,33699}
-- Lam S¡c Túc C¥u
x402040_g_SmallMonsterId_3={3700,3701,3702,3703,3704,3705,3706,3707,3708,3709,33700,33701,33702,33703,33704,33705,33706,33707,33708,33709}

-- ±äÉíºóµÄÖ÷¶¯¹Ö ÂúÌìÐÇ
x402040_g_MiddleMonsterId={3710,3711,3712,3713,3714,3715,3716,3717,3718,3719,33710,33711,33712,33713,33714,33715,33716,33717,33718,33719}

-- BOSS¹Ö ËïÃÀÃÀ £¨õí¾ÏÊ®ÈýÃÃ£©
x402040_g_BossMonsterId={3720,3721,3722,3723,3724,3725,3726,3727,3728,3729,33720,33721,33722,33723,33724,33725,33726,33727,33728,33729}

--ÄêÊÞ
x402040_g_NianShouID  = {12200,12201,12202,12203,12204,12205,12206,12207,12208,12209,12210,12211}
--ÊÇ·ñ´´½¨µÄ´ÎÊý
x402040_paramonce  = 14

-- ¼ÇÂ¼É±¹ÖÊýÁ¿µÄ¸±±¾±äÁ¿
x402040_g_KillNum = 20

-- ´ó×ãÇò
x402040_g_BigFootBall = {9160,9170,9180,9190,39160,39170,39180,39190}

--**********************************
--ÈÎÎñÈë¿Úº¯Êý
--**********************************
function x402040_OnDefaultEvent( sceneId, selfId, targetId )
	if GetNumText() == 1  then
		BeginEvent(sceneId)
			AddText(sceneId,"#BV« tr§n ð¤u Túc C¥u");
			AddText(sceneId,"#{CUDS_20071010}");
		EndEvent(sceneId)
		DispatchEventList(sceneId,selfId,targetId)
		return
	end

	-- 2£¬¼ì²âÍæ¼ÒÊÇ²»ÊÇ×é¶ÓÁË
	if LuaFnHasTeam(sceneId,selfId) ~= 1  then
		BeginEvent(sceneId)
			AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
			AddText(sceneId,"Mu¯n thØ thách ta chí ít cûng phäi t¾i 3 ngß¶i. Có tí ngß¶i thª này, quá coi thß¶ng ta");
		EndEvent(sceneId)
		DispatchEventList(sceneId,selfId,targetId)
		return
	end
	
	-- 3£¬¼ì²âÍæ¼Ò¶ÓÎéÈËÊý
	if GetTeamSize(sceneId,selfId) < x402040_g_LimitMembers then
		BeginEvent(sceneId)
			AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
			AddText(sceneId,"Mu¯n thØ thách ta chí ít cûng phäi t¾i 3 ngß¶i. Có tí ngß¶i thª này, quá coi thß¶ng ta");
		EndEvent(sceneId)
		DispatchEventList(sceneId,selfId,targetId)
		return
	end

	-- 4£¬¼ì²âÍæ¼ÒÊÇ²»ÊÇ¶Ó³¤
	if GetTeamLeader(sceneId,selfId) ~= selfId    then
		BeginEvent(sceneId)
			AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
			AddText(sceneId,"Mu¯n thØ thách ta? G÷i nhóm trß·ng cüa các ngß½i ra ðây");
		EndEvent(sceneId)
		DispatchEventList(sceneId,selfId,targetId)
		return
		
	end
	
	-- 5£¬¼ì²âÊÇ²»ÊÇÈË¶¼µ½Î»ÁË
	if GetTeamSize(sceneId,selfId) ~= GetNearTeamCount(sceneId,selfId)  then
		BeginEvent(sceneId)
			AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
			AddText(sceneId,"Ðµi hæu cüa ngß½i không · g¥n ðây");
		EndEvent(sceneId)
		DispatchEventList(sceneId,selfId,targetId)
		return
	end

	-- »ñµÃ¸½½üËùÓÐÍæ¼ÒÊý
	local nearteammembercount = GetNearTeamCount(sceneId, selfId)
	
	-- 6£¬¼ì²âÍæ¼Ò¶ÓÔ±ÀïÍ·ÓÐÃ»ÓÐÉ±Æø¹ýÖØµÄ
	for	i=0, nearteammembercount-1    do
		local memId = GetNearTeamMember(sceneId, selfId, i)
		local pk_value = LuaFnGetHumanPKValue( sceneId, memId )
		if pk_value and pk_value > 0 then
			BeginEvent(sceneId)
				AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
				AddText(sceneId,"Trong ðµi có ngß¶i sát khí quá n£ng không thích hþp tiªn vào.");
			EndEvent(sceneId)
			DispatchEventList(sceneId,selfId,targetId)
			
			return
		end
	end

	-- 7£¬Íæ¼ÒµÈ¼¶²»ÄÜµÍÓÚ30¼¶
	for	i=0, nearteammembercount-1    do
		local memId = GetNearTeamMember(sceneId, selfId, i)
		local level = GetLevel( sceneId, memId )
		if level < 30   then
			BeginEvent(sceneId)
				AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
				AddText(sceneId,"Trong nhóm cüa ngß½i có ngß¶i có ðÆng c¤p không ðü c¤p 30!");
			EndEvent(sceneId)
			DispatchEventList(sceneId,selfId,targetId)
			return
		end
	end
	
	-- 8£¬¼ì²âÊÇ²»ÊÇÓÐÈËÒÑ¾­²Î¼Ó¹ýõí¾Ï»î¶¯
	for	i=0, nearteammembercount-1    do
		local memId = GetNearTeamMember(sceneId, selfId, i)
		local time = GetMissionData(sceneId, memId, MD_CUJU_PRE_TIME)
		local nCurTime = LuaFnGetCurrentTime()
		-- ¿´ÉÏ´Î²Î¼ÓµÄÊ±¼äÊÇ²»ÊÇºÍÏÖÔÚÓÐ12¸öÐ¡Ê±ÒÔÉÏµÄCD
		if nCurTime-time < 60*60*4   then
			BeginEvent(sceneId)
				AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
				AddText(sceneId,"Ð×ng cho là ta ánh m¡t là chuyên môn l¤y ðªn xem mÛ næ d­ nhìn . Cái kia ai! Ngß½i không phäi m¾i v×a ðã mu¯n t¾i tham gia quá tr§n ð¤u  sao?#G thïnh quá 4 gi¶ lÕi ðªn ði!!");
			EndEvent(sceneId)
			DispatchEventList(sceneId,selfId,targetId)
			return
		end
	end
	
	-- 9£¬Ã¿¸ö¶ÓÔ±¶¼ÐèÒªÇ°6ÖÖÐÄ·¨´ïµ½30¼¶
	--for	i=0, nearteammembercount-1    do
	--	local memId = GetNearTeamMember(sceneId, selfId, i)
	--	if x402040_CheckAllXinfaLevel(sceneId, memId, 30) == 0  then
	--		BeginEvent(sceneId)
	--			AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n");
	--			AddText(sceneId,"  ÄãµÄ¶ÓÎéÖÐÓÐ¶ÓÔ±µÄÐÄ·¨µÈ¼¶²»×ã30¼¶£¬Õâ¿ÉÄÜÎÞ·¨ÊÊÓ¦Äµµ¤Íó´óÈüµÄ¼¤ÁÒÆ´ÇÀ¡£");
	--		EndEvent(sceneId)
	--		DispatchEventList(sceneId,selfId,targetId)
	--		return
	--	end
	--end
	
	-- 10£¬Âú×ãËùÓÐÌõ¼þÁË
	local str = "Ta chính thÑc tuyên b¯ " .. GetName(sceneId,selfId) .. " Cùng ðµi ngû ðã mu¯n có th¬ chính thÑc vào bàn, tham gia mµt tháng mµt l¥n  quét ngang mçu ð½n c± tay xúc cúc ðÕi tái!#r" .. GetName(sceneId,selfId) .. "#W, chúc ngß½i may m¡n."
	BeginEvent(sceneId)
		AddText(sceneId,"#BHoành täo M¦u Ðan Uy¬n")
		AddText(sceneId, str)
	EndEvent(sceneId)
	DispatchEventList(sceneId,selfId,targetId)

	x402040_MakeCopyScene(sceneId, selfId)
end

--**********************************
--ÁÐ¾ÙÊÂ¼þ
--**********************************
function x402040_OnEnumerate( sceneId, selfId, targetId )
	AddNumText( sceneId, x402040_g_ScriptId, "Liên quan hµi thi Túc C¥u",11 ,1  )
	AddNumText( sceneId, x402040_g_ScriptId, "Thiên Long Túc C¥u",10 ,-1  )
end

--**********************************
--¼ì²â½ÓÊÜÌõ¼þ
--**********************************
function x402040_CheckAccept( sceneId, selfId )
	
end

--**********************************
--Ñ¯ÎÊÍæ¼ÒÊÇ·ñÒª½øÈë¸±±¾
--**********************************
function x402040_AskEnterCopyScene( sceneId, selfId )
	
end

--**********************************
--½ÓÊÜ
--**********************************
function x402040_OnAccept( sceneId, selfId, targetId )
	
end

--**********************************
--Íæ¼ÒÍ¬Òâ½øÈë¸±±¾
--**********************************
function x402040_AcceptEnterCopyScene( sceneId, selfId )
	
end

--**********************************
--´´½¨¸±±¾
--**********************************
function x402040_MakeCopyScene( sceneId, selfId )
	
	-- Ê¹ÓÃ¶ÓÔ±µÄµÈ¼¶À´Ëã³ö¹ÖÎïµÄµÈ¼¶
	local param0 = 4;
	local param1 = 3;

	--×îÖÕ½á¹û
	local mylevel = 0;

	--ÁÙÊ±±äÁ¿
	local memId;
	local tempMemlevel = 0;
	local level0 = 0;
	local level1 = 0;
	local i;
	
	local nearmembercount = GetNearTeamCount(sceneId,selfId)
	for	i = 0, nearmembercount - 1 do
		memId = GetNearTeamMember(sceneId, selfId, i);
		tempMemlevel = GetLevel(sceneId, memId);
		level0 = level0 + (tempMemlevel ^ param0);
		level1 = level1 + (tempMemlevel ^ param1);
	end
	
	if level1 == 0 then
		mylevel = 0
	else
		mylevel = level0/level1;
	end
	
	if nearmembercount == -1  then  --Ã»ÓÐ¶ÓÎé
		mylevel = GetLevel(sceneId, selfId)
	end
	
	local x
	local z
	x,z = LuaFnGetWorldPos(sceneId,selfId)
	
	leaderguid=LuaFnObjId2Guid(sceneId,selfId)
	LuaFnSetSceneLoad_Map(sceneId, x402040_g_CopySceneMap); --µØÍ¼ÊÇ±ØÐëÑ¡È¡µÄ£¬¶øÇÒ±ØÐëÔÚConfig/SceneInfo.iniÀïÅäÖÃºÃ
	LuaFnSetCopySceneData_TeamLeader(sceneId, leaderguid);
	LuaFnSetCopySceneData_NoUserCloseTime(sceneId, x402040_g_NoUserTime*1000);
	LuaFnSetCopySceneData_Timer(sceneId, x402040_g_TickTime*1000);
	LuaFnSetCopySceneData_Param(sceneId, 0, x402040_g_CopySceneType);--ÉèÖÃ¸±±¾Êý¾Ý£¬ÕâÀï½«0ºÅË÷ÒýµÄÊý¾ÝÉèÖÃÎª999£¬ÓÃÓÚ±íÊ¾¸±±¾ºÅ999(Êý×Ö×Ô¶¨Òå)
	LuaFnSetCopySceneData_Param(sceneId, 1, x402040_g_ScriptId);--½«1ºÅÊý¾ÝÉèÖÃÎª¸±±¾³¡¾°ÊÂ¼þ½Å±¾ºÅ
	LuaFnSetCopySceneData_Param(sceneId, 2, 0);		--ÉèÖÃ¶¨Ê±Æ÷µ÷ÓÃ´ÎÊý
	LuaFnSetCopySceneData_Param(sceneId, 3, sceneId)	--ÉèÖÃ¸±±¾Èë¿Ú³¡¾°ºÅ, ³õÊ¼»¯
	LuaFnSetCopySceneData_Param(sceneId, 4, x);				--ÉèÖÃ¸±±¾µÄÈë¿Ú³¡¾°Î»ÖÃx
	LuaFnSetCopySceneData_Param(sceneId, 5, z);				--ÉèÖÃ¸±±¾µÄÈë¿Ú³¡¾°Î»ÖÃZ
	LuaFnSetCopySceneData_Param(sceneId, 6, GetTeamId(sceneId,selfId)); --±£´æ¶ÓÎéºÅ
	LuaFnSetCopySceneData_Param(sceneId, 7, 0) ;	--É±ËÀBossµÄÊýÁ¿
	
	for i=8, 31 do
		LuaFnSetCopySceneData_Param(sceneId, i, 0)
	end
	
	local PlayerMaxLevel = GetHumanMaxLevelLimit()
	local iniLevel;
	if mylevel < 10 then
		iniLevel = 1;
	elseif mylevel < PlayerMaxLevel then
		iniLevel = floor(mylevel/10);
	else
		iniLevel = PlayerMaxLevel/10;
	end
	if iniLevel==20 then
		iniLevel=20
	end
	-- Ê¹ÓÃ¸±±¾±äÁ¿8£¬9£¬10À´±£´æ¹ÖÎï±àºÅ
	LuaFnSetCopySceneData_Param(sceneId, 8, x402040_g_SmallMonsterId_1[iniLevel]) --Ð¡¹ÖID
	LuaFnSetCopySceneData_Param(sceneId, 9, x402040_g_SmallMonsterId_2[iniLevel]) --Ð¡¹ÖID
	LuaFnSetCopySceneData_Param(sceneId,10, x402040_g_SmallMonsterId_3[iniLevel]) --Ð¡¹ÖID

	LuaFnSetCopySceneData_Param(sceneId,11, x402040_g_MiddleMonsterId[iniLevel])--¾«Ó¢ID
	LuaFnSetCopySceneData_Param(sceneId,12, x402040_g_BossMonsterId[iniLevel]) 	--BossID
	
	-- Ê¹ÓÃµÚ11Î»£¬¼ÇÂ¼¹ÖÎïÊµ¼ÊµÄµÈ¼¶
	LuaFnSetCopySceneData_Param(sceneId,13, mylevel)
	LuaFnSetCopySceneData_Param(sceneId,21, iniLevel-1)
	
	--ÉèÖÃ³¡¾°ÖÐµÄ¸÷ÖÖNpcºÍÇøÓò
	LuaFnSetSceneLoad_Area( sceneId, "cuju_area.ini" )
	LuaFnSetSceneLoad_Monster( sceneId, "cuju_monster.ini" )

	local bRetSceneID = LuaFnCreateCopyScene(sceneId); --³õÊ¼»¯Íê³Éºóµ÷ÓÃ´´½¨¸±±¾º¯Êý
	BeginEvent(sceneId)
		if bRetSceneID>0 then
			AddText(sceneId,"D¸ch chuy¬n thành công!");
		else
			AddText(sceneId,"S¯ lßþng bän sao ðã ðªn gi¾i hÕn, ð« ngh¸ lát næa thØ lÕi!");
		end
	EndEvent(sceneId)
	DispatchMissionTips(sceneId,selfId)
	
end

--**********************************
--¸±±¾ÊÂ¼þ
--**********************************
function x402040_OnCopySceneReady( sceneId, destsceneId )

	--½øÈë¸±±¾µÄ¹æÔò
	-- 1£¬Èç¹ûÕâ¸öÍæ¼ÒÃ»ÓÐ×é¶Ó£¬¾Í´«ËÍÕâ¸öÍæ¼Ò×Ô¼º½øÈë¸±±¾
	-- 2, Èç¹ûÍæ¼ÒÓÐ¶ÓÎé£¬µ«ÊÇÍæ¼Ò²»ÊÇ¶Ó³¤£¬¾Í´«ËÍ×Ô¼º½øÈë¸±±¾
	-- 3£¬Èç¹ûÍæ¼ÒÓÐ¶ÓÎé£¬²¢ÇÒÕâ¸öÍæ¼ÒÊÇ¶Ó³¤£¬¾Í´«ËÍ×Ô¼ººÍ¸½½ü¶ÓÓÑÒ»Æð½øÈ¥

	LuaFnSetCopySceneData_Param(destsceneId, 3, sceneId) --ÉèÖÃ¸±±¾Èë¿Ú³¡¾°ºÅ
	leaderguid  = LuaFnGetCopySceneData_TeamLeader(destsceneId)
	leaderObjId = LuaFnGuid2ObjId(sceneId,leaderguid)
	
	if LuaFnIsCanDoScriptLogic( sceneId, leaderObjId ) ~= 1 then			-- ´¦ÓÚÎÞ·¨Ö´ÐÐÂß¼­µÄ×´Ì¬
		return
	end

	-- ¼ì²âÍæ¼ÒÊÇ²»ÊÇÓÐ¶ÓÎé
	if LuaFnHasTeam( sceneId, leaderObjId ) == 0  then   -- Ã»ÓÐ¶ÓÎé
		NewWorld( sceneId, leaderObjId, destsceneId, x402040_g_Fuben_X, x402040_g_Fuben_Z) ;
	else
		if IsCaptain(sceneId, leaderObjId) == 0  then
			NewWorld( sceneId, leaderObjId, destsceneId, x402040_g_Fuben_X, x402040_g_Fuben_Z) ;
		else
			local	nearteammembercount = GetNearTeamCount( sceneId, leaderObjId) 
			local mems = {}
			for	i=0,nearteammembercount-1 do
				mems[i] = GetNearTeamMember(sceneId, leaderObjId, i)
				NewWorld( sceneId, mems[i], destsceneId, x402040_g_Fuben_X, x402040_g_Fuben_Z) ;
			end
		end		
	end

end

--**********************************
--ÓÐÍæ¼Ò½øÈë¸±±¾ÊÂ¼þ
--**********************************
function x402040_OnPlayerEnter( sceneId, selfId )
	
	-- 2,¼ÇÂ¼Ê±¼ä
	local nPreTime = GetMissionData(sceneId,selfId, MD_CUJU_PRE_TIME)
	local nCurTime = LuaFnGetCurrentTime()

	SetMissionData(sceneId, selfId, MD_CUJU_PRE_TIME, nCurTime)
	
	-- 3,ÉèÖÃËÀÍöÊÂ¼þ
	SetPlayerDefaultReliveInfo( sceneId, selfId, "%50", -1, "0", sceneId, x402040_g_Fuben_X, x402040_g_Fuben_Z )
	
end

--**********************************
--ÓÐÍæ¼ÒÔÚ¸±±¾ÖÐËÀÍöÊÂ¼þ
--**********************************
function x402040_OnHumanDie( sceneId, selfId, killerId )
	
end

--**********************************
--·ÅÆú
--**********************************
function x402040_OnAbandon( sceneId, selfId )
	
end

--**********************************
-- »Ø³Ç£¬Ö»ÓÐ³ÇÊÐÈÎÎñ¸±±¾¿ÉÒÔµ÷ÓÃ´Ë½Ó¿Ú
--**********************************
function x402040_BackToCity( sceneId, selfId )
	
end

--**********************************
--¼ÌÐø
--**********************************
function x402040_OnContinue( sceneId, selfId, targetId )
	
end	

--**********************************
--¼ì²âÊÇ·ñ¿ÉÒÔÌá½»
--**********************************
function x402040_CheckSubmit( sceneId, selfId, selectRadioId )
	
end

--**********************************
--Ìá½»
--**********************************
function x402040_OnSubmit( sceneId, selfId, targetId, selectRadioId )
	
end

--**********************************
--É±ËÀ¹ÖÎï»òÍæ¼Ò
--**********************************
function x402040_OnKillObject( sceneId, selfId, objdataId, objId )
	
end

--**********************************
--½øÈëÇøÓòÊÂ¼þ
--**********************************
function x402040_OnEnterZone( sceneId, selfId, zoneId )
	
end

--**********************************
--µÀ¾ß¸Ä±ä
--**********************************
function x402040_OnItemChanged( sceneId, selfId, itemdataId )
	
end

--**********************************
--¸±±¾³¡¾°¶¨Ê±Æ÷ÊÂ¼þ
--**********************************
function x402040_OnCopySceneTimer( sceneId, nowTime )
--	local once = LuaFnGetCopySceneData_Param( sceneId, x402040_paramonce )
--
--	if (once == 0) then
--	
--		LuaFnSetCopySceneData_Param(sceneId, x402040_paramonce, 1)
--		--ÄêÊÞÈëÇÖ
--		local mylevel = LuaFnGetCopySceneData_Param( sceneId, 13 )
--	
--		local PlayerMaxLevel = GetHumanMaxLevelLimit()
--		local iniLevel;
--		if mylevel < 10 then
--			iniLevel = 10;
--		elseif mylevel < PlayerMaxLevel then
--			iniLevel = floor(mylevel/10) * 10;
--		else
--			iniLevel = PlayerMaxLevel;
--		end
--	
--		local iNianShouIdx = iniLevel / 10
--	
--		for i=1, 20 do
--			local objId = LuaFnCreateMonster( sceneId, x402040_g_NianShouID[iNianShouIdx], x402040_g_NianShouPoint[i].x, x402040_g_NianShouPoint[i].z, 1, 272, -1)
--			SetLevel( sceneId, objId, mylevel )
--			LuaFnSendSpecificImpactToUnit(sceneId, objId, objId, objId, 10472, 0); -- zchw
--		end  
--	end

		local nKillNum = LuaFnGetCopySceneData_Param(sceneId, 20)
		
		--PrintNum(nKillNum)

	-- ¼ÆÊ±Æ÷Ö÷ÒªÒª°´ÕÕÊ±¼äÀ´°²ÅÅË¢¹Ö
	local nPreTime = LuaFnGetCopySceneData_Param(sceneId, 15)
	local nCurTime = LuaFnGetCurrentTime()
	local nStep = LuaFnGetCopySceneData_Param(sceneId, 16)

	local SmallMonsterId_1	= LuaFnGetCopySceneData_Param(sceneId, 8)
	local SmallMonsterId_2	= LuaFnGetCopySceneData_Param(sceneId, 9)
	local SmallMonsterId_3	= LuaFnGetCopySceneData_Param(sceneId,10)
	local MiddleMonsterId	= LuaFnGetCopySceneData_Param(sceneId,11)
	local BossMonsterId		= LuaFnGetCopySceneData_Param(sceneId,12)
	
	local nMonsterLevel = LuaFnGetCopySceneData_Param(sceneId,13)
	
	local nPreBossSpeakTime = LuaFnGetCopySceneData_Param(sceneId,20)
	
	local arrayex = 0;           --À©Õ¹100¼¶ÒÔÉÏ£¬Êý×éÆ«ÒÆÁ¿
	local levelex = 0;           --À©Õ¹100¼¶ÒÔÉÏ£¬´óÂúÌìÐÇµÈ¼¶Æ«ÒÆÁ¿
	if(nMonsterLevel >= 110) then
	   arrayex = 4
	   levelex = 10
	end

	-- µÚÒ»´ÎÖ´ÐÐ¼ÆÊ±Æ÷	
	if nPreTime == 0 then
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		x402040_TipAllHuman( sceneId, "Thiên Long Túc C¥u s¨ b¡t ð¥u sau 60 giây!" )
		return
	end
	
	-- Ã¿¼ä¸ô10ÃëÌáÊ¾Íæ¼Ò£¬¡°Thiên Long Túc C¥u s¨ b¡t ð¥u sau AA giây!¡±
	if nStep==0 and nCurTime-nPreTime>=10  then
		x402040_TipAllHuman( sceneId, "Thiên Long Túc C¥u s¨ b¡t ð¥u sau 50 giây!" )
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep+1)
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		return
	end
	if nStep==1 and nCurTime-nPreTime>=10  then
		x402040_TipAllHuman( sceneId, "Thiên Long Túc C¥u s¨ b¡t ð¥u sau 40 giây!" )
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep+1)
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		return
	end
	if nStep==2 and nCurTime-nPreTime>=10  then
		x402040_TipAllHuman( sceneId, "Thiên Long Túc C¥u s¨ b¡t ð¥u sau 30 giây!" )
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep+1)
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		return
	end
	if nStep==3 and nCurTime-nPreTime>=10  then
		x402040_TipAllHuman( sceneId, "Thiên Long Túc C¥u s¨ b¡t ð¥u sau 20 giây!" )
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep+1)
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		return
	end
	if nStep==4 and nCurTime-nPreTime>=10  then
		x402040_TipAllHuman( sceneId, "Thiên Long Túc C¥u s¨ b¡t ð¥u sau 10 giây!" )
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep+1)
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime+5)
		return
	end
	
	local nMonsterNum = GetMonsterCount(sceneId)
	local bHaveMonster = 0
	for ii=0, nMonsterNum-1 do
		local nMonsterId = GetMonsterObjID(sceneId,ii)
		if GetName(sceneId, nMonsterId)== "Hoàng S¡c Túc C¥u" or 
			 GetName(sceneId, nMonsterId)== "H°ng S¡c Túc C¥u" or 
			 GetName(sceneId, nMonsterId)== "Lam S¡c Túc C¥u" 		 then
			if nowTime - GetObjCreateTime(sceneId, nMonsterId) > 60000  then
				-- ¼ì²âÕâ¸ö¹ÖµÄµ±Ç°ÑªÁ¿ÊÇ²»ÊÇ´óÓÚ×î´óÑªÁ¿µÄ1%£¬
				if GetHp(sceneId,nMonsterId) > 0  then
					-- É¾³ýÕâ¸ö¹Ö£¬ÔÚÕâ¸öÎ»ÖÃ´´½¨Ò»¸öÐÂµÄ¹Ö
					local PosX, PosZ = LuaFnGetWorldPos(sceneId, nMonsterId);
					PosX = floor(PosX);
					PosZ = floor(PosZ);
					
					LuaFnDeleteMonster(sceneId, nMonsterId)
					local nMiddleMonster = LuaFnCreateMonster(sceneId, MiddleMonsterId, PosX, PosZ, 3, 0, 402045);
					
					SetLevel(sceneId, nMiddleMonster, nMonsterLevel)
					SetNPCAIType(sceneId, nMiddleMonster, 0)
					SetCharacterName(sceneId, nMiddleMonster, "Hoa S¡c Túc C¥u")
				end
			end	
		end
		
		if GetName(sceneId, nMonsterId)== "Hoàng S¡c ÐÕi Túc C¥u" or 
			 GetName(sceneId, nMonsterId)== "H°ng S¡c ÐÕi Túc C¥u" or 
			 GetName(sceneId, nMonsterId)== "Lam S¡c ÐÕi Túc C¥u" 		 then
			if nowTime - GetObjCreateTime(sceneId, nMonsterId) > 60000  then
				-- ¼ì²âÕâ¸ö¹ÖµÄµ±Ç°ÑªÁ¿ÊÇ²»ÊÇ´óÓÚ×î´óÑªÁ¿µÄ1%£¬
				if GetHp(sceneId,nMonsterId) > 0  then
					-- É¾³ýÕâ¸ö¹Ö£¬ÔÚÕâ¸öÎ»ÖÃ´´½¨Ò»¸öÐÂµÄ¹Ö
					local PosX, PosZ = LuaFnGetWorldPos(sceneId, nMonsterId);
					PosX = floor(PosX);
					PosZ = floor(PosZ);
					
					LuaFnDeleteMonster(sceneId, nMonsterId)
					local nIniLevel = LuaFnGetCopySceneData_Param(sceneId, 21)
					local nBigBallId =x402040_g_BigFootBall[4 + arrayex]+nIniLevel-levelex
					local nMiddleMonster = LuaFnCreateMonster(sceneId, nBigBallId, PosX, PosZ, 3, 0, 402045);
					
					SetLevel(sceneId, nMiddleMonster, nMonsterLevel)
					SetNPCAIType(sceneId, nMiddleMonster, 0)
					SetCharacterName(sceneId, nMiddleMonster, "Hoa S¡c Túc C¥u")
				end
			end	
		end
	end

	if nStep>=5 and nStep<154 and nCurTime-nPreBossSpeakTime>=60 then
		LuaFnSetCopySceneData_Param(sceneId,20,nCurTime)
		
		local nRand = random(6)
		local str = ""
		if nRand == 1  then
			str = "#{_BOSS4}#P:Chúng ta là ngß¶i n¯i nghi®p Túc C¥u Trung Hoa! Kª th×a cao c¥u ð°ng quán  quang vinh truy«n th¯ng!"
		elseif nRand == 2  then
			str = "#{_BOSS4}#P:Mau mau mau, phân biên lÕp! HÕ ð¬ lÕp! Truy«n trung lÕp! Ð¥u c¥u công môn lÕp!"
		elseif nRand == 3  then
			str = "#{_BOSS4}#P:Hoa S¡c Túc C¥u, Hoàng S¡c Túc C¥u, H°ng S¡c Túc C¥u, Lam S¡c Túc C¥ut, tÕi ðây mµt kh¡c linh h°n chiªm ðßþc!"
		elseif nRand == 4  then
			str = "#{_BOSS4}#P:Ð¥y tr¶i tinh ðÕi bi¬u  ta tôn mî mî  quang vinh truy«n th¯ng! Nó không phäi mµt ngß¶i! Nó không phäi mµt ngß¶i!"
		elseif nRand == 5  then
			str = "#{_BOSS4}#P:Ai nha các ngß½i häo b±n a! Hoàng S¡c Túc C¥u, ngß½i nói, ngß½i nhß thª nào t±ng ðÑng làm cho ngß¶i ta gia ðánh a?"
		else
			str = "#{_BOSS4}#P:Ngß½i lÕi ðánh Túc C¥u, ngß¶i ta s¨ không v¾i ngß½i t¯t l¡m!"
		end
		
		-- ÔÚ³¡¾°·¶Î§ÄÚº°»°
		CallScriptFunction((200060), "Duibai",sceneId, "", "Mçu Ðan Uy¬n", str)
	end
	
	-- ÔÚË¢µÚ20£¬50£¬120¸ö×ãÇòÖ®Ç°£¬ÐèÒªÓÐÒ»Ð©Ð¡Çé½Ú
	if nStep==24 or nStep==54 or nStep==124  then
		local nStep_1 = LuaFnGetCopySceneData_Param(sceneId, 25)
		local nStep_1_T = LuaFnGetCopySceneData_Param(sceneId, 26)
		if nStep_1 == 0  then
			LuaFnSetCopySceneData_Param(sceneId, 25, nStep_1+1)
			LuaFnSetCopySceneData_Param(sceneId, 26, nCurTime)
			
			local str = ""
			if nStep==24 then
				str = "#{_BOSS4}#P:Ð×ng quá ð¡c ý ! Ch¶ ta thay ð±i ngß¶i! Lþi hÕi  còn tÕi m£t sau ðâu!"
			elseif nStep==24 then
				str = "#{_BOSS4}#P:Ai cß¶i ðáp cu¯i cùng! Ai cß¶i  t¯t nh¤t! Ta còn mu¯n thay ð±i ngß¶i!"
			else
				str = "#{_BOSS4}#P:Ngß½i xong r°i! Ta mu¯n ðªn lßþt ta cß¶ng ðÕi nh¤t ð¸a c¥u ðµi lên sân kh¤u !"
			end
			CallScriptFunction((200060), "Duibai",sceneId, "", "Mçu Ðan Uy¬n", str)
			x402040_TipAllHuman( sceneId, "Tôn MÛ MÛ yêu c¥u thay ð±i ngß¶i, 30 giây sau tr§n ð¤u tiªp tøc tiªn hành." )
			
		elseif nStep_1 == 1  then
			if nCurTime-nStep_1_T >= 10 then
				x402040_TipAllHuman( sceneId, "Tôn MÛ MÛ yêu c¥u thay ð±i ngß¶i, 20 giây sau tr§n ð¤u tiªp tøc tiªn hành." )
				
				LuaFnSetCopySceneData_Param(sceneId, 25, nStep_1+1)
				LuaFnSetCopySceneData_Param(sceneId, 26, nCurTime)
			end
			
		elseif nStep_1 == 2  then
			if nCurTime-nStep_1_T >= 10 then
				x402040_TipAllHuman( sceneId, "Tôn MÛ MÛ yêu c¥u thay ð±i ngß¶i, 10 giây sau tr§n ð¤u tiªp tøc tiªn hành." )
				
				LuaFnSetCopySceneData_Param(sceneId, 25, nStep_1+1)
				LuaFnSetCopySceneData_Param(sceneId, 26, nCurTime)
			end
			
		elseif nStep_1 == 3  then
			if nCurTime-nStep_1_T >= 10 then
				x402040_TipAllHuman( sceneId, "Tr§n ð¤u mµt l¥n lÕi næa b¡t ð¥u." )
				
				LuaFnSetCopySceneData_Param(sceneId, 25, nStep_1+1)
				LuaFnSetCopySceneData_Param(sceneId, 26, nCurTime)
				
				-- Ë¢Ò»¸ö´ó×ãÇò
				local nIniLevel = LuaFnGetCopySceneData_Param(sceneId, 21)
				
				local nBigFootballId = 0
				local ran = random(3)
				local szName = ""
				if ran == 1  then
					nBigFootballId  = x402040_g_BigFootBall[1 + arrayex]+nIniLevel-levelex
					szName = "Hoàng S¡c ÐÕi Túc C¥u"
				elseif ran == 2  then
					nBigFootballId  = x402040_g_BigFootBall[2 + arrayex]+nIniLevel-levelex
					szName = "H°ng S¡c ÐÕi Túc C¥u"
				else
					nBigFootballId  = x402040_g_BigFootBall[3 + arrayex]+nIniLevel-levelex
					szName = "Lam S¡c ÐÕi Túc C¥u"
				end
				
				local Point = x402040_g_MonsterPoint[nStep-4]
				local nNpc1 = LuaFnCreateMonster(sceneId, nBigFootballId, 
																					Point.x+random(2), 
																					Point.z, 
																					3, 0, 402045)
				SetLevel(sceneId, nNpc1, nMonsterLevel)
				SetCharacterName(sceneId, nNpc1, szName)
			end
			
		elseif nStep_1 == 4  then
			LuaFnSetCopySceneData_Param(sceneId, 25, 0)
			LuaFnSetCopySceneData_Param(sceneId, 26, nCurTime)
			
			LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
			LuaFnSetCopySceneData_Param(sceneId, 16, nStep+1)
		end
		
	end

	-- ÏÖ°´ÕÕ¼òµ¥µÄÃ¿10ÃëË¢Ò»´Î¹Ö
	if 	(nStep>=5   and nStep<24  and nCurTime-nPreTime >= 15) or
			(nStep>=25  and nStep<54  and nCurTime-nPreTime >= 12) or
			(nStep>=55  and nStep<124 and nCurTime-nPreTime >= 10) or
			(nStep>=125 and nStep<154	and nCurTime-nPreTime >= 5)   then
		
		-- ¹ÖÎïÉú³Éµã
		if nStep == 5  then
			x402040_TipAllHuman( sceneId, "Tr§n ð¤u Túc C¥u chính thÑc b¡t ð¥u" )
		end
		
		local Point = x402040_g_MonsterPoint[nStep-4]
	
		-- ¹ÖÎïID
		local nMonsterId = 0 
		local ran = random(3)
		if ran == 1  then
			nMonsterId = SmallMonsterId_1
		elseif ran == 2  then
			nMonsterId = SmallMonsterId_2
		else
			nMonsterId = SmallMonsterId_3
		end
		
		local nNpc1 = LuaFnCreateMonster(sceneId, nMonsterId, Point.x+random(2), Point.z, 3, 0, 402045)
		SetLevel(sceneId, nNpc1, nMonsterLevel)
		--SetNPCAIType(sceneId, nNpc1, 0)
		
		if ran == 1  then
			SetCharacterName(sceneId, nNpc1, "Hoàng S¡c Túc C¥u")
		elseif ran == 2  then
			SetCharacterName(sceneId, nNpc1, "H°ng S¡c Túc C¥u")
		else
			SetCharacterName(sceneId, nNpc1, "Lam S¡c Túc C¥u")
		end
		
		nStep = nStep+1
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep)
	end
		
	if nStep==154 then
		-- ¼ì²âÊÇ²»ÊÇËùÓÐµÄÐ¡¹Ö¶¼ËÀ¹â£¬Èç¹ûËÀ¹â£¬10Ãëºó¹Ì¶¨µØµãË¢BOSS
		local nMonsterNum = GetMonsterCount(sceneId)
		local bHaveMonster = 0
		for ii=0, nMonsterNum-1 do
			local nMonsterId = GetMonsterObjID(sceneId,ii)
			if GetName(sceneId, nMonsterId)== "Hoàng S¡c Túc C¥u" then
				bHaveMonster = 1
				break
			end
			if GetName(sceneId, nMonsterId)== "H°ng S¡c Túc C¥u" then
				bHaveMonster = 1
				break
			end
			if GetName(sceneId, nMonsterId)== "Lam S¡c Túc C¥u" then
				bHaveMonster = 1
				break
			end
			if GetName(sceneId, nMonsterId)== "Hoa S¡c Túc C¥u" then
				bHaveMonster = 1
				break
			end
		end

		if bHaveMonster == 0   then
			nStep = nStep+1
			LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
			LuaFnSetCopySceneData_Param(sceneId, 16, nStep)
		end
	end
	
	if 	nStep==155 then
		x402040_TipAllHuman( sceneId, "Tôn MÛ MÛ 10 giây sau s¨ xu¤t hi®n" )
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep+1)
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		return
		
	end
	
	if 	nStep==156 and nCurTime-nPreTime>=10  then
		nStep = nStep+1
		LuaFnSetCopySceneData_Param(sceneId, 15, nCurTime)
		LuaFnSetCopySceneData_Param(sceneId, 16, nStep)
		local nNpc1 = LuaFnCreateMonster(sceneId, BossMonsterId, x402040_g_BossPoint.x, x402040_g_BossPoint.z, 19, 216, 402040)
		SetLevel(sceneId, nNpc1, nMonsterLevel)
		SetNPCAIType(sceneId, nNpc1, 0)
		SetCharacterName(sceneId, nNpc1, "Tôn MÛ MÛ")
		SetCharacterTitle(sceneId, nNpc1, "Túc C¥u Th§p Tam Muµi Muµi")
		
		x402040_TipAllHuman( sceneId, "Tôn MÛ MÛ ðã xu¤t hi®n" )
	end
	
end

--**********************************
--¼ì²âÐÄ·¨ÊÇ²»¹»½ÓÈÎÎñ
--**********************************
function x402040_OnDie(sceneId, objId, killerId)
	--É±ËÀ¹ÖÎïµÄÊÇ³èÎïÔò»ñÈ¡ÆäÖ÷ÈËµÄID....
	local playerID = killerId
	local objType = GetCharacterType( sceneId, killerId )
	if objType == 3 then
		playerID = GetPetCreator( sceneId, killerId )
	end
		--Èç¹û×éÁË¶ÓÔò»ñÈ¡¶Ó³¤µÄID....
	local nLeaderId = GetTeamLeader(sceneId, playerID)
	if nLeaderId < 1   then
		nLeaderId = playerID
	end
	
	local str = ""
	str = format("#PTÕi Mçu Ðan Uy¬n, #{_INFOUSR%s}#P th¯ng lînh ðµi ngû ðánh bÕi #{_BOSS4}#P, ðÕt ðßþc mµt h°i nh© nhàng vui vë ð¥m ðìa ðÕi th¡ng!", GetName(sceneId,nLeaderId))
	BroadMsgByChatPipe(sceneId, nLeaderId, str, 4)
	
end

--**********************************
--¼ì²âÐÄ·¨ÊÇ²»¹»½ÓÈÎÎñ
--**********************************
function x402040_CheckAllXinfaLevel(sceneId, selfId, level)
	local nMenpai = GetMenPai(sceneId, selfId)
	if nMenpai<0 or nMenpai>8   then
		return 0
	end
	
	for i=1, 6 do
		local nXinfaLevel = LuaFnGetXinFaLevel(sceneId, selfId, nMenpai*6 + i)
		if nXinfaLevel < level    then
			return 0
		end
	end
	return 1
end

--**********************************
--ÌáÊ¾ËùÓÐ¸±±¾ÄÚÍæ¼Ò
--**********************************
function x402040_TipAllHuman( sceneId, Str )
	-- »ñµÃ³¡¾°ÀïÍ·µÄËùÓÐÈË
	local nHumanNum = LuaFnGetCopyScene_HumanCount(sceneId)
	
	-- Ã»ÓÐÈËµÄ³¡¾°£¬Ê²Ã´¶¼²»×ö
	if nHumanNum < 1 then
		return
	end
	
	for i=0, nHumanNum-1  do
		local PlayerId = LuaFnGetCopyScene_HumanObjId(sceneId, i)
		BeginEvent(sceneId)
			AddText(sceneId, Str)
		EndEvent(sceneId)
		DispatchMissionTips(sceneId, PlayerId)
	end
end

